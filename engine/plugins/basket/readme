# =========================================================================== #
# NG CMS // РџР»Р°РіРёРЅС‹ // РљРѕСЂР·РёРЅР° Р·Р°РєР°Р·Р°                                         #
# =========================================================================== #

 РџР»Р°РіРёРЅ "РєРѕСЂР·РёРЅР° Р·Р°РєР°Р·Р°" РїРѕР·РІРѕР»СЏРµС‚ СЃРґРµР»Р°С‚СЊ РёР· NGCMS РЅРµР±РѕР»СЊС€РѕР№ РёРЅС‚РµСЂРЅРµС‚-РјР°РіР°Р·РёРЅ.
Р’ СЃРІРѕРµР№ СЂР°Р±РѕС‚Рµ РїР»Р°РіРёРЅ РёСЃРїРѕР»СЊР·СѓРµС‚ РїР»Р°РіРёРЅС‹:
* xfields - РґР»СЏ С„РѕСЂРјРёСЂРѕРІР°РЅРёСЏ СЃРїРёСЃРєР° С‚РѕРІР°СЂРѕРІ, РґРѕСЃС‚СѓРїРЅРѕРіРѕ Рє Р·Р°РєР°Р·Сѓ
* feedback - РґР»СЏ Р·Р°РїРѕР»РЅРµРЅРёСЏ РґР°РЅРЅС‹С… Рѕ Р·Р°РєР°Р·Рµ Рё РѕС‚РїСЂР°РІРєРё СЃР°РјРѕРіРѕ Р·Р°РєР°Р·Р° 
  Р°РґРјРёРЅРёСЃС‚СЂР°С‚РѕСЂР°Рј/РјРµРЅРµРґР¶РµСЂР°Рј СЃР°Р№С‚Р°


РћСЃРЅРѕРІРЅС‹Рµ С€Р°РіРё РґР»СЏ РЅР°СЃС‚СЂРѕР№РєРё/РёСЃРїРѕР»СЊР·РѕРІР°РЅРёСЏ РїР»Р°РіРёРЅР°:
==== XFields ====
1. РќРµРѕР±С…РѕРґРёРјРѕ РѕРїСЂРµРґРµР»РёС‚СЊ РґР»СЏ РєР°РєРёС… Р·Р°РїРёСЃРµР№ Р±СѓРґРµС‚ РѕС‚РѕР±СЂР°Р¶Р°С‚СЊСЃСЏ СЃСЃС‹Р»РєР° "РґРѕР±Р°РІРёС‚СЊ РІ РєРѕСЂР·РёРЅСѓ"
1.1. Р”Р»СЏ РІСЃРµС… РЅРѕРІРѕСЃС‚РµР№
1.2. РўРѕР»СЊРєРѕ РґР»СЏ С‚РµС… РЅРѕРІРѕСЃС‚РµР№ РІ РєРѕС‚РѕСЂС‹С… РµСЃС‚СЊ РІС‹Р±СЂР°РЅРЅРѕРµ РІР°РјРё РґРѕРї. РїРѕР»Рµ Рё РµРіРѕ Р·РЅР°С‡РµРЅРёРµ РѕС‚Р»РёС‡РЅРѕ РѕС‚ РЅСѓР»СЏ
2. РЎРѕР·РґР°С‚СЊ РїРѕР»Рµ РІ РєРѕС‚РѕСЂРѕРј Р±СѓРґРµС‚ С…СЂР°РЅРёС‚СЊСЃСЏ СЃС‚РѕРёРјРѕСЃС‚СЊ 1 РµРґРёРЅРёС†С‹

==== Feedback ====
1. РЎРѕР·РґР°С‚СЊ С„РѕСЂРјСѓ, РєРѕС‚РѕСЂР°СЏ Р±СѓРґРµС‚ РёСЃРїРѕР»СЊР·РѕРІР°С‚СЊСЃСЏ РїСЂРё С„РѕСЂРјРёСЂРѕРІР°РЅРёРё Р·Р°РєР°Р·Р° (СЂРµР¶РёРј СЂР°СЃСЃС‹Р»РєРё - HTML)
[ == С‚РµРєСѓС‰Р°СЏ РІРµСЂСЃРёСЏ РѕС‚РїСЂР°РІР»СЏРµС‚ Р·Р°РєР°Р· С‚РѕР»СЊРєРѕ РЅР° СѓРєР°Р·Р°РЅРЅС‹Рµ РІ С„РѕСЂРјРµ email'С‹, РѕС‚РїСЂР°РІРєР° РєРѕРїРёРё Р·Р°РєР°Р·Р° РµРіРѕ Р°РІС‚РѕСЂСѓ - РЅРµРІРѕР·РјРѕР¶РЅР° == ]

==== Basket =====
1. РќР°СЃС‚СЂРѕРёС‚СЊ СѓСЃР»РѕРІРёСЏ Р°РєС‚РёРІР°С†РёРё
2. Р’С‹Р±СЂР°С‚СЊ С„РѕСЂРјСѓ РѕР±СЂР°С‚РЅРѕР№ СЃРІСЏР·Рё

==== РЁР°Р±Р»РѕРЅС‹ =====
> РўРµРєСЃС‚ email РЅРѕС‚РёС„РёРєР°С†РёРё:
Р’ С€Р°Р±Р»РѕРЅРµ plugins/feedback/tpl/mail.html.tpl РґРѕР±Р°РІРёС‚СЊ РІ РЅСѓР¶РЅРѕРµ РјРµСЃС‚Рѕ РїРµСЂРµРјРµРЅРЅСѓСЋ {{ plugin_basket }}

> РЎРѕР±СЃС‚РІРµРЅРЅС‹Рµ С€Р°Р±Р»РѕРЅС‹ РїР»Р°РіРёРЅР° Р»РµР¶Р°С‚ РІ templates/default/plugins/basket/

> Р’ mail.tpl РґРѕСЃС‚СѓРїРЅР° РїРµСЂРµРјРµРЅРЅР°СЏ {plugin_basket}, РѕРЅР° Р·Р°РїРѕР»РЅСЏРµС‚СЃСЏ РёР· С€Р°Р±Р»РѕРЅР° РїР»Р°РіРёРЅР° total.tpl

> Р’ news.short.tpl Рё news.full.tpl РґРѕСЃС‚СѓРїРЅРѕ:
/* Р”Р°РЅРЅС‹Р№ СЃРїРѕСЃРѕР± СѓСЃС‚Р°СЂРµР», РІ РґР°РЅРЅС‹Р№ РјРѕРјРµРЅС‚ РёСЃРїРѕР»СЊР·СѓРµС‚СЃСЏ AJAX РґРѕР±Р°РІР»РµРЅРёРµ С‚РѕРІР°СЂРѕРІ РІ РєРѕСЂР·РёРЅСѓ, СЃРј. РЅРёР¶Рµ */
Р±Р»РѕРє [basket]..[/basket] (РѕС‚РѕР±СЂР°Р¶Р°РµС‚СЃСЏ РїСЂРё РІРѕР·РјРѕР¶РЅРѕСЃС‚Рё РїРѕР»РѕР¶РёС‚СЊ СЌС‚РѕС‚ С‚РѕРІР°СЂ РІ РєРѕРЅР·РёРЅСѓ)
РїРµСЂРµРјРµРЅРЅР°СЏ {basket_link} СЃРѕ СЃСЃС‹Р»РєРѕР№ РЅР° URL РґРѕР±Р°РІР»РµРЅРёСЏ С‚РѕРІР°СЂР° РІ РєРѕСЂР·РёРЅСѓ
/* Р”Р°РЅРЅС‹Р№ СЃРїРѕСЃРѕР± СѓСЃС‚Р°СЂРµР», РІ РґР°РЅРЅС‹Р№ РјРѕРјРµРЅС‚ РёСЃРїРѕР»СЊР·СѓРµС‚СЃСЏ AJAX РґРѕР±Р°РІР»РµРЅРёРµ С‚РѕРІР°СЂРѕРІ РІ РєРѕСЂР·РёРЅСѓ, СЃРј. РЅРёР¶Рµ */

** РїР»Р°РіРёРЅ РґРѕР±Р°РІР»СЏРµС‚ СЃРІРѕСЋ js Р±РёР±Р»РёРѕС‚РµРєСѓ basket.js, РѕРЅР° РїРѕР·РІРѕР»СЏРµС‚ РґРѕР±Р°РІР»СЏС‚СЊ С‚РѕРІР°СЂС‹ РІ РєРѕСЂР·РёРЅСѓ С‡РµСЂРµР· AJAX
РїСЂРёРјРµСЂ РїСЂР°РІРёР»СЊРЅРѕРіРѕ РєРѕРґР° РґР»СЏ РґРѕР±Р°РІР»РµРЅРёСЏ:
[basket]<a href="#" onclick="rpcBasketRequest('plugin.basket.manage', {'action': 'add', 'ds':1,'id':{news-id},'count':1}); return false;">Р’ РєРѕСЂР·РёРЅСѓ</a>[/basket]

РџР»Р°РіРёРЅ РїРѕР·РІРѕР»СЏРµС‚ СЂР°Р±РѕС‚Р°С‚СЊ РІ СЂР°Р·РЅС‹С… СЂРµР¶РёРјР°С…:
- РјРѕР¶РЅРѕ РёСЃРїРѕР»СЊР·РѕРІР°С‚СЊ РЅРѕРІРѕСЃС‚СЊ РєР°Рє РµРґРµРЅРёС†Сѓ С‚РѕРІР°СЂР°, РѕРґРЅР° РЅРѕРІРѕСЃС‚СЊ - РѕРґРёРЅ С‚РѕРІР°СЂ, С‚РѕРіРґР° "Р Р°Р±РѕС‚Р° СЃ РґРѕРї. РїРѕР»СЏРјРё РІРЅСѓС‚СЂРё РЅРѕРІРѕСЃС‚РµР№"
- РјРѕР¶РЅРѕ РёСЃРїРѕР»СЊР·РѕРІР°С‚СЊ РЅРѕРІРѕСЃС‚СЊ РєР°Рє РіСЂСѓРїРїСѓ С‚РѕРІР°СЂРѕРІ Рё РІС‹Р±РёСЂР°С‚СЊ С‡С‚Рѕ РґРѕР±Р°РІР»СЏС‚СЊ РІ РєРѕСЂР·РёРЅСѓ Р±СѓРґРµС€ РёР· С‚Р°Р±Р»РёС†С‹ "Р Р°Р±РѕС‚Р° СЃ С‚Р°Р±Р»РёС†Р°РјРё РґРѕРї. РїРѕР»РµР№ РІРЅСѓС‚СЂРё РЅРѕРІРѕСЃС‚РµР№"
- СЂР°Р±РѕС‚Р°СЋС‚ Рё СЃРѕРІРјРµСЃС‚РЅРѕ Рё РїРѕРѕРґРёРЅРѕС‡РєРµ РґР°Р¶Рµ РІ РїСЂРµРґРµР»Р°С… РѕРґРЅРѕР№ РЅРѕРІРѕСЃС‚Рё Рё РЅР°РїСЂР°РІР»СЏСЋС‚СЃСЏ РІ РєРѕСЂР·РёРЅСѓ Р±РµР· РєРѕРЅС„Р»РёРєС‚РѕРІ

РќР°РїСЂРёРјРµСЂ, РµСЃР»Рё РЅРѕРІРѕСЃС‚СЊ - СЌС‚Рѕ РµРґРµРЅРёС†Р° С‚РѕРІР°СЂР°. Р’РЅСѓС‚СЂРё РЅРѕРІРѕСЃС‚Рё РјРѕР¶РЅРѕ РёСЃРїРѕР»СЊР·РѕРІР°С‚СЊ С‚Р°Р±Р»РёС‡РЅС‹Рµ РґР°РЅРЅС‹Рµ РїР»Р°РіРёРЅР° xfields - СЌС‚Рѕ РѕРґРёРЅ Рё С‚РѕС‚ Р¶Рµ С‚РѕРІР°СЂ РЅРѕ СЃ СЂР°Р·РЅРѕР№ С†РµРЅРѕР№, С†РІРµС‚РѕРј, СЂР°Р·РјРµСЂРѕРј, С‚Рѕ РІС‹РІРѕРґ СЂР°Р·Р»РёС‡РЅС‹С… РјРѕРґРёС„РёРєР°С†РёР№ С‚РѕРІР°СЂРѕРІ
РјРѕР¶РµС‚ РІС‹РіР»СЏРґРµС‚СЊ С‚Р°Рє:
{% for xdata in p.xfields._table.data %}
    <tr>
        <td> ID:{{ xdata.id }}</td>
        <td> Р¦РІРµС‚: {{ xdata.field_color }}</td>
        <td> Р¦РµРЅР°: {{ xdata.field_prais }}</td>
        <td><a href="#" class="add_item_to_basket" data-tblid="{{ xdata.id }}">Р’ РєРѕСЂР·РёРЅСѓ</a></td>
    </tr>
{% endfor %}
AJAX РѕР±СЂР°Р±РѕС‚С‡РёРє РЅР°Р¶Р°С‚РёСЏ РґРѕР±Р°РІР»РµРЅРёСЏ С‚РѕРІР°СЂР° РІ РєРѕСЂР·РёРЅСѓ РЅР° JQ:
$(".add_item_to_basket").click(function () {
    var count = $("input[name*='count']").val();
    var tblid = 0;
    tblid = $(this).attr("data-tblid");
    rpcBasketRequest('plugin.basket.manage', {'action': 'add', 'ds':51,'id':tblid,'count':count}); return false;
});

> total.tpl - РћР±С‰РёР№ РІС‹РІРѕРґ РїРѕ Р·Р°РєР°Р·Р°Рј РІ РєРѕСЂР·РёРЅРµ, СЂР°Р±РѕС‚Р°РµС‚ РІ main.tpl
РџРµСЂРµРјРµРЅРЅС‹Рµ:
{{ count }} - РєРѕР»-РІРѕ Р·Р°РїРёСЃРµР№
{{ price }} - РѕР±С‰Р°СЏ СЃС‚РѕРёРјРѕСЃС‚СЊ
...

> list.tpl - РљРѕСЂР·РёРЅР° Р·Р°РєР°Р·Р° (СЃ РІРѕР·РјРѕР¶РЅРѕСЃС‚СЊСЋ РѕР±РЅРѕРІР»СЏС‚СЊ РєРѕР»-РІРѕ Р·Р°РєР°Р·Р°РЅРЅС‹С… С‚РѕРІР°СЂРѕРІ)
{{ recs }} - РєРѕР»-РІРѕ Р·Р°РїРёСЃРµР№
{{ entries }} - РјР°СЃСЃРёРІ СЃРѕ РІСЃРµРјРё Р·Р°РїРёСЃСЏРјРё РєРѕСЂР·РёРЅС‹
	{{ entry.title }} - РЅР°РёРјРµРЅРѕРІР°РЅРёРµ С‚РѕРІР°СЂР°
	{{ entry.count }} - РєРѕР»-РІРѕ С‚РѕРІР°СЂР°
	{{ etry.sum }}	  - РѕР±С‰Р°СЏ СЃС‚РѕРёРјРѕСЃС‚СЊ С‚РѕРІР°СЂР°
	{{ entry.xfields.news.NAME }} - СЃРѕРґРµСЂР¶РёРјРѕРµ РґРѕРї. РїРѕР»СЏ NAME РІ РЅРѕРІРѕСЃС‚Рё РёР· РєРѕС‚РѕСЂРѕР№ РґРµР»Р°Р»СЃСЏ Р·Р°РєР°Р·
	{{ entry.xfields.tdata.NAME }} - СЃРѕРґРµСЂР¶РёРјРѕРµ РґРѕРї. РїРѕР»СЏ РїСЂРё Р·Р°РєР°Р·Рµ РёР· С‚Р°Р±Р»РёС†С‹ РІРЅСѓС‚СЂРё РЅРѕРІРѕСЃС‚Рё
...

Р‘РѕР»РµРµ РїРѕРґСЂРѕР±РЅР°СЏ РёРЅС„РѕСЂРјР°С†РёСЏ Рѕ РІРѕР·РјРѕР¶РЅРѕСЃС‚СЏС… РїР»Р°РіРёРЅР°:
http://ngcms.ru/forum/viewtopic.php?id=2705
http://ngcms.ru/forum/viewtopic.php?id=2746
http://ngcms.ru/forum/viewtopic.php?pid=30259#p30259
http://ngcms.ru/forum/viewtopic.php?id=3743